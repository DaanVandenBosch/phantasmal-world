(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{549:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var s=r(659),i=r(136);s.a.install({THREE:Object.assign(Object.assign({},i),{MOUSE:Object.assign(Object.assign({},i.MOUSE),{LEFT:i.MOUSE.RIGHT,RIGHT:i.MOUSE.LEFT})})});class n{constructor(e){this._debug=!1,this.scene=new i.Scene,this.light_holder=new i.Group,this.render_scheduled=!1,this.animation_frame_handle=void 0,this.light=new i.HemisphereLight(16777215,5263440,1),this.controls_clock=new i.Clock,this.size=new i.Vector2(0,0),this.schedule_render=()=>{this.render_scheduled=!0},this.on_mouse_down=e=>{e.currentTarget&&e.currentTarget.focus()},this.call_render=()=>{const e=this.controls.update(this.controls_clock.getDelta()),t=this.render_scheduled||e;this.render_scheduled=!1,t&&this.render(),this.animation_frame_handle=requestAnimationFrame(this.call_render)},this.renderer=e,this.renderer.domElement.tabIndex=0,this.renderer.domElement.addEventListener("mousedown",this.on_mouse_down),this.renderer.domElement.style.outline="none",this.scene.background=new i.Color(1579032),this.light_holder.add(this.light),this.scene.add(this.light_holder)}get debug(){return this._debug}set debug(e){this._debug=e}get canvas_element(){return this.renderer.domElement}set_size(e,t){this.size.set(e,t),this.renderer.setSize(e,t),this.schedule_render()}pointer_pos_to_device_coords(e){e.set(e.x/this.size.width*2-1,e.y/this.size.height*-2+1)}start_rendering(){null==this.animation_frame_handle&&(this.schedule_render(),this.animation_frame_handle=requestAnimationFrame(this.call_render))}stop_rendering(){null!=this.animation_frame_handle&&(cancelAnimationFrame(this.animation_frame_handle),this.animation_frame_handle=void 0)}reset_camera(e,t){this.controls.setLookAt(e.x,e.y,e.z,t.x,t.y,t.z)}dispose(){this.renderer.dispose(),this.controls.dispose()}init_camera_controls(){this.controls=new s.a(this.camera,this.renderer.domElement),this.controls.dampingFactor=1,this.controls.draggingDampingFactor=1}render(){this.renderer.render(this.scene,this.camera)}}},579:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var s=r(136);function i(e){return e.textures.map(n)}function n(e){let t,r;switch(e.format[1]){case 6:t=s.RGBA_S3TC_DXT1_Format,r=e.width*e.height/2;break;case 7:t=s.RGBA_S3TC_DXT3_Format,r=e.width*e.height;break;default:throw new Error(`Format ${e.format.join(", ")} not supported.`)}const i=new s.CompressedTexture([{data:new Uint8Array(e.data,0,r),width:e.width,height:e.height}],e.width,e.height,t);return i.minFilter=s.LinearFilter,i.wrapS=s.MirroredRepeatWrapping,i.wrapT=s.MirroredRepeatWrapping,i.needsUpdate=!0,i}},837:function(e,t,r){"use strict";r.r(t),r.d(t,"TextureRenderer",(function(){return l}));var s=r(15),i=r(24),n=r(579),a=r(136),o=r(549);const h=i.a.get("viewer/rendering/TextureRenderer"),d=Object.freeze(new a.Vector3(0,0,5)),c=Object.freeze(new a.Vector3(0,0,0));class l extends o.a{constructor(e,t){super(t),this.disposer=new s.a,this.quad_meshes=[],this.camera=new a.OrthographicCamera(-400,400,300,-300,1,10),this.disposer.add_all(e.textures.observe(({value:e})=>{this.scene.remove(...this.quad_meshes),this.create_quads(e),this.reset_camera(d,c),this.schedule_render()})),this.init_camera_controls(),this.controls.azimuthRotateSpeed=0,this.controls.polarRotateSpeed=0}set_size(e,t){this.camera.left=-Math.floor(e/2),this.camera.right=Math.ceil(e/2),this.camera.top=Math.floor(t/2),this.camera.bottom=-Math.ceil(t/2),this.camera.updateProjectionMatrix(),super.set_size(e,t)}dispose(){super.dispose(),this.disposer.dispose()}create_quads(e){let t=10*(e.length-1),r=0;for(const s of e)t+=s.width,r=Math.max(r,s.height);let s=-Math.floor(t/2);const i=-Math.floor(r/2);for(const t of e){let e=void 0;try{e=Object(n.b)(t)}catch(e){h.error("Couldn't convert XVR texture.",e)}const o=new a.Mesh(this.create_quad(s,i+Math.floor((r-t.height)/2),t.width,t.height),e?new a.MeshBasicMaterial({map:e,transparent:!0}):new a.MeshBasicMaterial({color:16711935}));this.quad_meshes.push(o),this.scene.add(o),s+=10+t.width}}create_quad(e,t,r,s){const i=new a.PlaneGeometry(r,s,1,1);return i.faceVertexUvs=[[[new a.Vector2(0,0),new a.Vector2(0,1),new a.Vector2(1,0)],[new a.Vector2(0,1),new a.Vector2(1,1),new a.Vector2(1,0)]]],i.translate(e+r/2,t+s/2,-5),i}}}}]);
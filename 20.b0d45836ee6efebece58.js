(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{472:function(t,e,r){"use strict";var s;r.d(e,"d",(function(){return s})),r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),r.d(e,"c",(function(){return o})),r.d(e,"f",(function(){return a})),r.d(e,"e",(function(){return h})),r.d(e,"g",(function(){return d})),function(t){t[t.PosNorm=0]="PosNorm",t[t.PosTex=1]="PosTex",t[t.PosNormTex=2]="PosNormTex"}(s||(s={}));const n=0,i=1,o=2;function a(t){switch(t){case s.PosNorm:return 24;case s.PosTex:return 16;case s.PosNormTex:return 28}}function h(t){switch(t){case s.PosTex:return-1;case s.PosNorm:case s.PosNormTex:return 12}}function d(t){switch(t){case s.PosNorm:return-1;case s.PosTex:return 12;case s.PosNormTex:return 24}}},496:function(t,e,r){"use strict";var s;r.d(e,"b",(function(){return s})),r.d(e,"a",(function(){return n})),function(t){t[t.RGBA_S3TC_DXT1=0]="RGBA_S3TC_DXT1",t[t.RGBA_S3TC_DXT3=1]="RGBA_S3TC_DXT3"}(s||(s={}));class n{constructor(t,e,r,s,n){this.gfx=t,this.format=e,this.width=r,this.height=s,this.data=n}upload(){null==this.gfx_texture&&(this.gfx_texture=this.gfx.create_texture(this.format,this.width,this.height,this.data))}destroy(){this.gfx.destroy_texture(this.gfx_texture)}}},519:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i}));var s=r(463);class n{constructor(){this.root_node=new i(void 0,s.a.identity())}traverse(t,e){this.traverse_node(this.root_node,t,e)}traverse_node(t,e,r){const s=e(t,r);for(const r of t.children)this.traverse_node(r,e,s)}}class i{constructor(t,e,...r){this.mesh=t,this.transform=e,this._children=r}get children(){return this._children}add_child(t){this._children.push(t)}clear_children(){this._children.splice(0)}}},545:function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return o})),r.d(e,"c",(function(){return a}));var s=r(136),n=r(496);function i(t,e){let r,s;switch(e.format[1]){case 6:r=n.b.RGBA_S3TC_DXT1,s=e.width*e.height/2;break;case 7:r=n.b.RGBA_S3TC_DXT3,s=e.width*e.height;break;default:throw new Error(`Format ${e.format.join(", ")} not supported.`)}return new n.a(t,r,e.width,e.height,e.data.slice(0,s))}function o(t){return t.textures.map(a)}function a(t){let e,r;switch(t.format[1]){case 6:e=s.RGBA_S3TC_DXT1_Format,r=t.width*t.height/2;break;case 7:e=s.RGBA_S3TC_DXT3_Format,r=t.width*t.height;break;default:throw new Error(`Format ${t.format.join(", ")} not supported.`)}const n=new s.CompressedTexture([{data:new Uint8Array(t.data,0,r),width:t.width,height:t.height}],t.width,t.height,e);return n.minFilter=s.LinearFilter,n.wrapS=s.MirroredRepeatWrapping,n.wrapT=s.MirroredRepeatWrapping,n.needsUpdate=!0,n}},654:function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var s=r(472);class n{constructor(t){this.format=t,this.vertex_data=[],this.index_data=[]}get vertex_count(){return this.vertex_data.length}triangle(t,e,r){return this.index_data.push(t,e,r),this}build(){const t=Object(s.f)(this.format),e=Object(s.e)(this.format),r=Object(s.g)(this.format),n=new ArrayBuffer(this.vertex_data.length*t),i=new DataView(n);let o=0;for(const{pos:s,normal:n,tex:a}of this.vertex_data)i.setFloat32(o,s.x,!0),i.setFloat32(o+4,s.y,!0),i.setFloat32(o+8,s.z,!0),-1!==e&&(i.setFloat32(o+e,n.x,!0),i.setFloat32(o+e+4,n.y,!0),i.setFloat32(o+e+8,n.z,!0)),-1!==r&&(i.setUint16(o+r,65535*a.x,!0),i.setUint16(o+r+2,65535*a.y,!0)),o+=t;const a=new Uint16Array(2*Math.ceil(this.index_data.length/2));return a.set(this.index_data),new h(this.format,n,a,this.index_data.length,this._texture)}}class i extends n{constructor(){super(s.d.PosNorm)}vertex(t,e){return this.vertex_data.push({pos:t,normal:e}),this}}class o extends n{constructor(){super(s.d.PosTex)}vertex(t,e){return this.vertex_data.push({pos:t,tex:e}),this}texture(t){return this._texture=t,this}}class a extends n{constructor(){super(s.d.PosNormTex)}vertex(t,e,r){return this.vertex_data.push({pos:t,normal:e,tex:r}),this}texture(t){return this._texture=t,this}}class h{constructor(t,e,r,s,n){this.format=t,this.vertex_data=e,this.index_data=r,this.index_count=s,this.texture=n}static builder(t){switch(t){case s.d.PosNorm:return new i;case s.d.PosTex:return new o;case s.d.PosNormTex:return new a}}upload(t){var e;null===(e=this.texture)||void 0===e||e.upload(),null==this.gfx_mesh&&(this.gfx_mesh=t.create_gfx_mesh(this.format,this.vertex_data,this.index_data,this.texture))}destroy(t){t.destroy_gfx_mesh(this.gfx_mesh)}}},840:function(t,e,r){"use strict";r.r(e),r.d(e,"TextureRenderer",(function(){return u}));var s=r(15),n=r(23),i=r(472),o=r(654),a=r(545),h=r(463),d=r(519);const c=n.a.get("viewer/rendering/TextureRenderer");class u{constructor(t,e){this.renderer=e,this.disposer=new s.a,this.canvas_element=e.canvas_element,e.camera.pan(0,0,10),this.disposer.add_all(t.textures.observe(({value:t})=>{e.destroy_scene(),e.camera.reset(),this.create_quads(t),e.schedule_render()}))}dispose(){this.renderer.dispose(),this.disposer.dispose()}start_rendering(){this.renderer.start_rendering()}stop_rendering(){this.renderer.stop_rendering()}set_size(t,e){this.renderer.set_size(t,e)}create_quads(t){let e=10*(t.length-1),r=0;for(const s of t)e+=s.width,r=Math.max(r,s.height);let s=-Math.floor(e/2);const n=-Math.floor(r/2);for(const e of t){try{const t=this.create_quad(e);t.upload(this.renderer.gfx),this.renderer.scene.root_node.add_child(new d.b(t,h.a.translation(s,n+(r-e.height)/2,0)))}catch(t){c.error("Couldn't create quad for texture.",t)}s+=10+e.width}}create_quad(t){return o.a.builder(i.d.PosTex).vertex(new h.c(0,0,0),new h.b(0,1)).vertex(new h.c(t.width,0,0),new h.b(1,1)).vertex(new h.c(t.width,t.height,0),new h.b(1,0)).vertex(new h.c(0,t.height,0),new h.b(0,0)).triangle(0,1,2).triangle(2,3,0).texture(Object(a.b)(this.renderer.gfx,t)).build()}}}}]);
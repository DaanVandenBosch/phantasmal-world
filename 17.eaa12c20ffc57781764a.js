(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{463:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));const s=2*Math.PI/65536,i=65536/(2*Math.PI);function r(t){return t*s}function o(t){return Math.round(t*i)}},490:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a}));var s=n(463);const i=1296321870;var r,o;function a(t,e){return t.u32()===i?function(t,e){const n=t.u32();return _(t.take(n),e)}(t,e):(t.seek_start(0),function(t,e){t.seek_end(16);const n=t.u32();t.seek_start(n);const s=t.u32();return t.seek_start(s),function(t,e){t.seek(4);const n=t.u32();return t.seek_start(n),_(t,e)}(t,e)}(t,e))}function _(t,e){let n=t.u32();const s=t.u32(),i=t.u16(),r=t.u16(),a=(192&r)>>6,_=15&r,l=[];for(let r=0;r<e;r++){t.seek_start(n),n=n+=8*_;const e={tracks:[]};l.push(e);const r=[],a=[];for(let e=0;e<_;e++)r.push(t.u32());for(let e=0;e<_;e++){const e=t.u32();a.push(e)}if(1&i){t.seek_start(r.shift());const n=a.shift();n&&e.tracks.push({type:o.Position,keyframes:c(t,n)})}if(2&i){t.seek_start(r.shift());const n=a.shift();n&&e.tracks.push({type:o.Rotation,keyframes:u(t,n,s)})}if(4&i){t.seek_start(r.shift());const n=a.shift();n&&e.tracks.push({type:o.Scale,keyframes:c(t,n)})}}return{motion_data:l,frame_count:s,type:i,interpolation:a,element_count:_}}function c(t,e){const n=[];for(let s=0;s<e;++s)n.push({frame:t.u32(),value:t.vec3_f32()});return n}function u(t,e,n){const i=[],r=t.position;for(let n=0;n<e;++n)i.push({frame:t.u16(),value:{x:Object(s.a)(t.u16()),y:Object(s.a)(t.u16()),z:Object(s.a)(t.u16())}});let o=-1;for(const{frame:s}of i){if(s<o||s>=n)return t.seek_start(r),l(t,e);o=s}return i}function l(t,e){const n=[];for(let i=0;i<e;++i)n.push({frame:t.u32(),value:{x:Object(s.a)(t.i32()),y:Object(s.a)(t.i32()),z:Object(s.a)(t.i32())}});return n}!function(t){t[t.Linear=0]="Linear",t[t.Spline=1]="Spline",t[t.UserFunction=2]="UserFunction"}(r||(r={})),function(t){t[t.Position=0]="Position",t[t.Rotation=1]="Rotation",t[t.Scale=2]="Scale"}(o||(o={}))},544:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var s=n(136),i=n(490);const r=30;function o(t,e){const n=e.interpolation===i.a.Spline?s.InterpolateSmooth:s.InterpolateLinear,o=[];return e.motion_data.forEach((e,a)=>{const _=t.get_bone(a);_&&e.tracks.forEach(({type:t,keyframes:e})=>{const c=[],u=[];for(const n of e)if(c.push(n.frame/r),t===i.b.Rotation){const t=_.evaluation_flags.zxy_rotation_order?"ZXY":"ZYX",e=(new s.Quaternion).setFromEuler(new s.Euler(n.value.x,n.value.y,n.value.z,t));u.push(e.x,e.y,e.z,e.w)}else u.push(n.value.x,n.value.y,n.value.z);if(t===i.b.Rotation)o.push(new s.QuaternionKeyframeTrack(`.bones[${a}].quaternion`,c,u,n));else{const e=t===i.b.Position?`.bones[${a}].position`:`.bones[${a}].scale`;o.push(new s.VectorKeyframeTrack(e,c,u,n))}})}),new s.AnimationClip("Animation",(e.frame_count-1)/r,o).optimize()}},630:function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"h",(function(){return r})),n.d(e,"f",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"k",(function(){return _})),n.d(e,"l",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"d",(function(){return y})),n.d(e,"c",(function(){return m}));class s{constructor(t){var e,n,s,i,r;this.name=t.name,this.body_style_count=null!==(e=t.body_style_count)&&void 0!==e?e:1,this.head_style_count=t.head_style_count,this.hair_style_count=t.hair_style_count,this.hair_styles_with_accessory=t.hair_styles_with_accessory,this.body_tex_ids=null!==(n=t.body_tex_ids)&&void 0!==n?n:[],this.head_tex_ids=null!==(s=t.head_tex_ids)&&void 0!==s?s:[],this.hair_tex_ids=null!==(i=t.hair_tex_ids)&&void 0!==i?i:[],this.accessory_tex_ids=null!==(r=t.accessory_tex_ids)&&void 0!==r?r:[]}}const i=new s({name:"HUmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([6])}),r=new s({name:"HUnewearl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set}),o=new s({name:"HUcast",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),a=new s({name:"HUcaseal",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),_=new s({name:"RAmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),c=new s({name:"RAmarl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),u=new s({name:"RAcast",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),l=new s({name:"RAcaseal",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),h=new s({name:"FOmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),d=new s({name:"FOmarl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),y=new s({name:"FOnewm",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),m=new s({name:"FOnewearl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])})},903:function(t,e,n){"use strict";n.r(e),n.d(e,"ModelStore",(function(){return y}));var s=n(59),i=n(630),r=n(14);class o{constructor(t,e){this.id=t,this.name=e}}var a=n(544),_=n(31),c=n(23),u=n(36),l=n(64),h=function(t,e,n,s){return new(n||(n=Promise))((function(i,r){function o(t){try{_(s.next(t))}catch(t){r(t)}}function a(t){try{_(s.throw(t))}catch(t){r(t)}}function _(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}_((s=s.apply(t,e||[])).next())}))};const d=c.a.get("viewer/stores/ModelStore");class y extends s.a{constructor(t,e,n){super(),this.asset_loader=e,this.random=n,this._current_character_class=Object(r.e)(void 0),this._current_section_id=Object(r.e)(void 0),this._current_body=Object(r.e)(void 0),this._current_animation=Object(r.e)(void 0),this._current_nj_object=Object(r.e)(void 0),this._current_textures=Object(r.c)(),this._current_nj_motion=Object(r.e)(void 0),this._show_skeleton=Object(r.e)(!1),this._animation_playing=Object(r.e)(!0),this._animation_frame_rate=Object(r.e)(a.a),this._animation_frame=Object(r.e)(0),this.character_classes=[i.g,i.h,i.f,i.e,i.k,i.l,i.j,i.i,i.a,i.b,i.d,i.c],this.current_character_class=this._current_character_class,this.current_section_id=this._current_section_id,this.current_body=this._current_body,this.animations=new Array(572).fill(void 0).map((t,e)=>new o(e,`Animation ${e+1}`)),this.current_animation=this._current_animation,this.current_nj_object=this._current_nj_object,this.current_textures=this._current_textures,this.current_nj_motion=this._current_nj_motion,this.animation_frame_count=this.current_nj_motion.map(t=>t?t.frame_count:0),this.show_skeleton=this._show_skeleton,this.animation_playing=this._animation_playing,this.animation_frame_rate=this._animation_frame_rate,this.animation_frame=this._animation_frame,this.set_current_character_class=t=>{if(this._current_character_class.val!==t){if(null==t)this.set_current_body(void 0);else{const e=this.current_body.val;(void 0===e||e>=(null==t?void 0:t.body_style_count))&&this.set_current_body(t.body_style_count-1)}this._current_character_class.val=t,null==this.current_animation.val&&this.set_current_nj_motion(void 0)}},this.set_current_section_id=t=>{this._current_section_id.val=t},this.set_current_body=t=>{this._current_body.val=t},this.set_current_animation=t=>{this._current_animation.val!==t&&(this._current_animation.val=t)},this.set_current_nj_object=t=>{this.set_current_character_class(void 0),this.set_current_animation(void 0),this.set_current_textures([]),this.set_current_nj_motion(void 0),this._current_nj_object.val=t},this.set_current_textures=t=>{this._current_textures.val=t},this.set_current_nj_motion=t=>{this.set_current_animation(void 0),this._current_nj_motion.val=t},this.set_show_skeleton=t=>{this._show_skeleton.val=t},this.set_animation_playing=t=>{this._animation_playing.val=t},this.set_animation_frame_rate=t=>{this._animation_frame_rate.val=t},this.set_animation_frame=t=>{this._animation_frame.val=t},this.load_character_class_model=()=>h(this,void 0,void 0,(function*(){const t=this.current_character_class.val;if(null==t)return;const e=this.current_section_id.val;if(null==e)return;const n=this.current_body.val;if(null!=n)try{const s=yield this.asset_loader.load_geometry(t);this._current_textures.val=yield this.asset_loader.load_textures(t,e,n),this._current_nj_object.val=s}catch(e){d.error(`Couldn't load model for ${t.name}.`),this._current_nj_object.val=void 0}})),this.load_animation=()=>h(this,void 0,void 0,(function*(){const t=this._current_nj_object.val,e=this.current_animation.val;if(t&&e)try{this._current_nj_motion.val=yield this.asset_loader.load_animation(e.id,64),this.set_animation_playing(!0)}catch(t){d.error(`Couldn't load animation "${e.name}".`,t),this._current_nj_motion.val=void 0}else this._current_nj_motion.val=void 0})),this.disposables(this.current_character_class.observe(this.load_character_class_model),this.current_section_id.observe(this.load_character_class_model),this.current_body.observe(this.load_character_class_model),this.current_animation.observe(this.load_animation)),this.disposables(t.bind_parameter(u.b.Viewer,"/models","model",this.current_character_class.map(t=>void 0===t?void 0:t.name)),t.bind_parameter(u.b.Viewer,"/models","section_id",this.current_section_id.map(t=>void 0===t?void 0:_.e[t])),t.bind_parameter(u.b.Viewer,"/models","body",this.current_body.map(t=>void 0===t?void 0:String(t+1))));const s=t.get_parameter(u.b.Viewer,"/models","model");let c=this.character_classes.find(t=>t.name===s);null==c&&(c=n.sample_array(this.character_classes));const y=t.get_parameter(u.b.Viewer,"/models","body");let m=null==y?void 0:parseInt(y,10);null!=m&&Number.isInteger(m)?m--:m=n.integer(0,c.body_style_count);const f=t.get_parameter(u.b.Viewer,"/models","section_id"),b=void 0===f?void 0:Object(l.b)(_.e,f);this._current_section_id.val=null!=b?b:n.sample_array(_.f),this._current_body.val=m,this._current_character_class.val=c}}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"7CyS":function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o}));var n=i("Womt"),s=i("VwSi");const r=30;function o(t,e){const i=e.interpolation===s.a.Spline?n.InterpolateSmooth:n.InterpolateLinear,o=[];return e.motion_data.forEach((e,a)=>{const _=t.get_bone(a);_&&e.tracks.forEach(({type:t,keyframes:e})=>{const u=[],h=[];for(const i of e)if(u.push(i.frame/r),t===s.b.Rotation){const t=_.evaluation_flags.zxy_rotation_order?"ZXY":"ZYX",e=(new n.Quaternion).setFromEuler(new n.Euler(i.value.x,i.value.y,i.value.z,t));h.push(e.x,e.y,e.z,e.w)}else h.push(i.value.x,i.value.y,i.value.z);if(t===s.b.Rotation)o.push(new n.QuaternionKeyframeTrack(`.bones[${a}].quaternion`,u,h,i));else{const e=t===s.b.Position?`.bones[${a}].position`:`.bones[${a}].scale`;o.push(new n.VectorKeyframeTrack(e,u,h,i))}})}),new n.AnimationClip("Animation",(e.frame_count-1)/r,o).optimize()}},"9Ykw":function(t,e,i){"use strict";function n(t){const e=[];for(;t.bytes_left;){const i=t.u32(),n=t.u32();if(n>t.bytes_left)break;e.push({type:i,data:t.take(n)})}return e}i.d(e,"a",(function(){return n}))},"9dYx":function(t,e,i){"use strict";var n=i("bcBH");class s{constructor(t,e){this._position=0,this.endianness=t,this.offset=e}get position(){return this._position}get endianness(){return this.little_endian?n.a.Little:n.a.Big}set endianness(t){this.little_endian=t===n.a.Little}get bytes_left(){return this.size-this.position}seek(t){return this.seek_start(this.position+t)}seek_start(t){if(t<0||t>this.size)throw new Error(`Offset ${t} is out of bounds.`);return this._position=t,this}seek_end(t){if(t<0||t>this.size)throw new Error(`Offset ${t} is out of bounds.`);return this._position=this.size-t,this}u8(){return this.u8_at(this._position++)}u8_at(t){return this.check_offset(t,1),this.dv.getUint8(this.offset+t)}u16(){const t=this.u16_at(this.position);return this._position+=2,t}u16_at(t){return this.check_offset(t,2),this.dv.getUint16(this.offset+t,this.little_endian)}u32(){const t=this.u32_at(this.position);return this._position+=4,t}u32_at(t){return this.check_offset(t,4),this.dv.getUint32(this.offset+t,this.little_endian)}i8(){return this.i8_at(this._position++)}i8_at(t){return this.check_offset(t,1),this.dv.getInt8(this.offset+t)}i16(){const t=this.i16_at(this.position);return this._position+=2,t}i16_at(t){return this.check_offset(t,2),this.dv.getInt16(this.offset+t,this.little_endian)}i32(){const t=this.i32_at(this.position);return this._position+=4,t}i32_at(t){return this.check_offset(t,4),this.dv.getInt32(this.offset+t,this.little_endian)}f32(){const t=this.f32_at(this.position);return this._position+=4,t}f32_at(t){return this.check_offset(t,4),this.dv.getFloat32(this.offset+t,this.little_endian)}u8_array(t){this.check_size("n",t,t);const e=[];for(let i=0;i<t;++i)e.push(this.dv.getUint8(this.offset+this._position++));return e}u16_array(t){this.check_size("n",t,2*t);const e=[];for(let i=0;i<t;++i)e.push(this.dv.getUint16(this.offset+this.position,this.little_endian)),this._position+=2;return e}u32_array(t){this.check_size("n",t,4*t);const e=[];for(let i=0;i<t;++i)e.push(this.dv.getUint32(this.offset+this.position,this.little_endian)),this._position+=4;return e}i32_array(t){this.check_size("n",t,4*t);const e=[];for(let i=0;i<t;++i)e.push(this.dv.getInt32(this.offset+this.position,this.little_endian)),this._position+=4;return e}vec2_f32(){return{x:this.f32(),y:this.f32()}}vec3_f32(){return{x:this.f32(),y:this.f32(),z:this.f32()}}string_ascii(t,e,i){const n=[];for(let s=0;s<t;s++){const r=this.u8();if(e&&0===r){i&&this.seek(t-s-1);break}n.push(r)}return String.fromCodePoint(...n)}string_utf16(t,e,i){const n=[],s=Math.floor(t/2);for(let t=0;t<s;t++){const r=this.u16();if(e&&0===r){i&&this.seek(2*(s-t-1));break}n.push(r)}return String.fromCodePoint(...n)}string_ascii_at(t,e,i){const n=[];for(let s=0;s<e;s++){const e=this.u8_at(t+s);if(i&&0===e)break;n.push(e)}return String.fromCodePoint(...n)}string_utf16_at(t,e,i){const n=[],s=Math.floor(e/2);for(let e=0;e<s;e++){const s=this.u16_at(t+2*e);if(i&&0===s)break;n.push(s)}return String.fromCodePoint(...n)}array_buffer(t=this.size-this.position){this.check_size("size",t,t);const e=this.backing_buffer.slice(this.offset+this.position,this.offset+this.position+t);return this._position+=t,e}copy_to_uint8_array(t,e=this.size-this.position){return this.check_size("size",e,e),t.set(new Uint8Array(this.backing_buffer,this.offset+this.position,e)),this._position+=e,this}check_size(t,e,i){if(i<0||i>this.size-this.position)throw new Error(`${t} ${e} is out of bounds.`)}check_offset(t,e){if(t<0||t+e>this.size)throw new Error(`Offset ${t} is out of bounds.`)}}i.d(e,"a",(function(){return r}));class r extends s{write_u8(t){return this.write_u8_at(this.position,t),this._position+=1,this}write_u16(t){return this.write_u16_at(this.position,t),this._position+=2,this}write_u32(t){return this.write_u32_at(this.position,t),this._position+=4,this}write_i8(t){return this.write_i8_at(this.position,t),this._position+=1,this}write_i16(t){return this.write_i16_at(this.position,t),this._position+=2,this}write_i32(t){return this.write_i32_at(this.position,t),this._position+=4,this}write_f32(t){return this.write_f32_at(this.position,t),this._position+=4,this}write_u8_array(t){return this.write_u8_array_at(this.position,t),this._position+=t.length,this}write_u16_array(t){return this.write_u16_array_at(this.position,t),this._position+=2*t.length,this}write_u32_array(t){return this.write_u32_array_at(this.position,t),this._position+=4*t.length,this}write_vec2_f32(t){return this.write_vec2_f32_at(this.position,t),this._position+=8,this}write_vec3_f32(t){return this.write_vec3_f32_at(this.position,t),this._position+=12,this}write_cursor(t){const e=t.size-t.position;return this.ensure_size(e),t.copy_to_uint8_array(new Uint8Array(this.backing_buffer,this.offset+this.position,e),e),this._position+=e,this}write_string_ascii(t,e){return this.write_string_ascii_at(this.position,t,e),this._position+=e,this}write_string_utf16(t,e){return this.write_string_utf16_at(this.position,t,e),this._position+=e,this}write_u8_at(t,e){return this.ensure_size(1,t),this.dv.setUint8(t,e),this}write_u16_at(t,e){return this.ensure_size(2,t),this.dv.setUint16(t,e,this.little_endian),this}write_u32_at(t,e){return this.ensure_size(4,t),this.dv.setUint32(t,e,this.little_endian),this}write_i8_at(t,e){return this.ensure_size(1,t),this.dv.setInt8(t,e),this}write_i16_at(t,e){return this.ensure_size(2,t),this.dv.setInt16(t,e,this.little_endian),this}write_i32_at(t,e){return this.ensure_size(4,t),this.dv.setInt32(t,e,this.little_endian),this}write_f32_at(t,e){return this.ensure_size(4,t),this.dv.setFloat32(t,e,this.little_endian),this}write_u8_array_at(t,e){return this.ensure_size(e.length,t),new Uint8Array(this.backing_buffer,this.offset+t).set(new Uint8Array(e)),this}write_u16_array_at(t,e){this.ensure_size(2*e.length,t);const i=e.length;for(let n=0;n<i;n++)this.write_u16_at(t+2*n,e[n]);return this}write_u32_array_at(t,e){this.ensure_size(4*e.length,t);const i=e.length;for(let n=0;n<i;n++)this.write_u32_at(t+4*n,e[n]);return this}write_vec2_f32_at(t,e){return this.ensure_size(8,t),this.dv.setFloat32(t,e.x,this.little_endian),this.dv.setFloat32(t+4,e.y,this.little_endian),this}write_vec3_f32_at(t,e){return this.ensure_size(12,t),this.dv.setFloat32(t,e.x,this.little_endian),this.dv.setFloat32(t+4,e.y,this.little_endian),this.dv.setFloat32(t+8,e.z,this.little_endian),this}write_string_ascii_at(t,e,i){this.ensure_size(i,t);const n=Math.min(i,e.length);for(let i=0;i<n;i++)this.write_u8_at(t+i,e.codePointAt(i));const s=i-n;for(let e=0;e<s;e++)this.write_u8_at(t+n+e,0);return this}write_string_utf16_at(t,e,i){this.ensure_size(i,t);const n=Math.floor(i/2),s=Math.min(n,e.length);for(let i=0;i<s;i++)this.write_u16_at(t+2*i,e.codePointAt(i));const r=n-s;for(let e=0;e<r;e++)this.write_u16_at(t+2*s+2*e,0);return this}ensure_size(t,e=this.position){const i=this.size-e;if(t>i)throw new Error(`${t} Bytes required but only ${i} available.`)}}},NRxM:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("9dYx");class s extends n.a{constructor(t,e,i=0,n=t.byteLength-i){super(e,i),this._size=n,this.backing_buffer=t,this.dv=new DataView(t,0,t.byteLength)}get size(){return this._size}set size(t){if(t>this.backing_buffer.byteLength-this.offset)throw new Error(`Size ${t} is out of bounds.`);this._size=t}take(t){const e=this.offset+this.position,i=new s(this.backing_buffer,this.endianness,e,t);return this._position+=t,i}}},"Sa3/":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function o(t){try{_(n.next(t))}catch(t){r(t)}}function a(t){try{_(n.throw(t))}catch(t){r(t)}}function _(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}_((n=n.apply(t,e||[])).next())}))};function s(t){return n(this,void 0,void 0,(function*(){return new Promise((e,i)=>{const n=new FileReader;n.addEventListener("loadend",()=>{n.result instanceof ArrayBuffer?e(n.result):i(new Error("Couldn't read file."))}),n.readAsArrayBuffer(t)})}))}},VwSi:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a}));var n=i("kwt4");const s=1296321870;var r,o;function a(t,e){return t.u32()===s?function(t,e){const i=t.u32();return _(t.take(i),e)}(t,e):(t.seek_start(0),function(t,e){t.seek_end(16);const i=t.u32();t.seek_start(i);const n=t.u32();return t.seek_start(n),function(t,e){t.seek(4);const i=t.u32();return t.seek_start(i),_(t,e)}(t,e)}(t,e))}function _(t,e){let i=t.u32();const n=t.u32(),s=t.u16(),r=t.u16(),a=(192&r)>>6,_=15&r,c=[];for(let r=0;r<e;r++){t.seek_start(i),i=i+=8*_;const e={tracks:[]};c.push(e);const r=[],a=[];for(let e=0;e<_;e++)r.push(t.u32());for(let e=0;e<_;e++){const e=t.u32();a.push(e)}if(1&s){t.seek_start(r.shift());const i=a.shift();i&&e.tracks.push({type:o.Position,keyframes:u(t,i)})}if(2&s){t.seek_start(r.shift());const i=a.shift();i&&e.tracks.push({type:o.Rotation,keyframes:h(t,i,n)})}if(4&s){t.seek_start(r.shift());const i=a.shift();i&&e.tracks.push({type:o.Scale,keyframes:u(t,i)})}}return{motion_data:c,frame_count:n,type:s,interpolation:a,element_count:_}}function u(t,e){const i=[];for(let n=0;n<e;++n)i.push({frame:t.u32(),value:t.vec3_f32()});return i}function h(t,e,i){const s=[],r=t.position;for(let i=0;i<e;++i)s.push({frame:t.u16(),value:{x:t.u16()*n.a,y:t.u16()*n.a,z:t.u16()*n.a}});let o=-1;for(const{frame:n}of s){if(n<o||n>=i)return t.seek_start(r),c(t,e);o=n}return s}function c(t,e){const i=[];for(let s=0;s<e;++s)i.push({frame:t.u32(),value:{x:t.i32()*n.a,y:t.i32()*n.a,z:t.i32()*n.a}});return i}!function(t){t[t.Linear=0]="Linear",t[t.Spline=1]="Spline",t[t.UserFunction=2]="UserFunction"}(r||(r={})),function(t){t[t.Position=0]="Position",t[t.Rotation=1]="Rotation",t[t.Scale=2]="Scale"}(o||(o={}))},bcBH:function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"}(n||(n={}))},kwt4:function(t,e,i){"use strict";var n=i("9Ykw"),s=i("rwco");const r=s.c.get("core/data_formats/parsing/ninja/njcm");var o;function a(t,e){const i=t.u32(),n=t.u32(),s=t.vec3_f32(),r=t.f32(),a=[],u=[];if(i){t.seek_start(i);for(const i of _(t,e,!0))if(i.type===o.Vertex)for(const t of i.vertices)a[t.index]={position:t.position,normal:t.normal,bone_weight:t.bone_weight,bone_weight_status:t.bone_weight_status,calc_continue:t.calc_continue}}if(n){t.seek_start(n);let i=void 0;for(const n of _(t,e,!1))if(n.type===o.Tiny)i=n.texture_id;else if(n.type===o.Strip){for(const t of n.triangle_strips)t.texture_id=i;u.push(...n.triangle_strips)}}return{type:"njcm",vertices:a,meshes:u,collision_sphere_center:s,collision_sphere_radius:r}}function _(t,e,i){const n=[];let s=!0;for(;s;){const a=t.u8(),c=t.u8(),f=t.position;let l=0;if(0===a)n.push({type:o.Null,type_id:a});else if(1<=a&&a<=3)n.push({type:o.Bits,type_id:a});else if(4===a){const i=c,r=t.position;n.push({type:o.CachePolygonList,type_id:a,cache_index:i,offset:r}),e[i]=r,s=!1}else if(5===a){const s=c,r=e[s];null!=r&&(t.seek_start(r),n.push(..._(t,e,i))),n.push({type:o.DrawPolygonList,type_id:a,cache_index:s})}else if(8<=a&&a<=9){l=2;const e=t.u16();n.push({type:o.Tiny,type_id:a,flip_u:0!=(128&a),flip_v:0!=(64&a),clamp_u:0!=(32&a),clamp_v:0!=(16&a),mipmap_d_adjust:15&a,filter_mode:e>>>14,super_sample:0!=(64&e),texture_id:8191&e})}else 17<=a&&a<=31?(l=2+2*t.u16(),n.push({type:o.Material,type_id:a})):32<=a&&a<=50?(l=2+4*t.u16(),n.push({type:o.Vertex,type_id:a,vertices:u(t,a,c)})):56<=a&&a<=58?(l=2+2*t.u16(),n.push({type:o.Volume,type_id:a})):64<=a&&a<=75?(l=2+2*t.u16(),n.push({type:o.Strip,type_id:a,triangle_strips:h(t,a,c)})):255===a?(l=i?2:0,n.push({type:o.End,type_id:a}),s=!1):(l=2+2*t.u16(),n.push({type:o.Unknown,type_id:a}),r.warn(`Unknown chunk type ${a} at offset ${f}.`));t.seek_start(f+l)}return n}function u(t,e,i){if(e<32||e>50)return r.warn(`Unknown vertex chunk type ${e}.`),[];const n=3&i,s=0!=(128&i),o=t.u16(),a=t.u16(),_=[];for(let i=0;i<a;++i){const r={index:o+i,position:t.vec3_f32(),bone_weight:1,bone_weight_status:n,calc_continue:s};if(32===e)t.seek(4);else if(33===e)t.seek(4),r.normal=t.vec3_f32(),t.seek(4);else if(35<=e&&e<=40)37===e?(r.index=o+t.u16(),r.bone_weight=t.u16()/255):t.seek(4);else if(41<=e&&e<=47)r.normal=t.vec3_f32(),e>=42&&(44===e?(r.index=o+t.u16(),r.bone_weight=t.u16()/255):t.seek(4));else if(48<=e&&e<=50){const i=t.u32();r.normal={x:(i>>20&1023)/1023,y:(i>>10&1023)/1023,z:(1023&i)/1023},e>=49&&t.seek(4)}_.push(r)}return _}function h(t,e,i){const n={ignore_light:0!=(1&i),ignore_specular:0!=(2&i),ignore_ambient:0!=(4&i),use_alpha:0!=(8&i),double_side:0!=(16&i),flat_shading:0!=(32&i),environment_mapping:0!=(64&i)},s=t.u16(),r=s>>>14,o=16383&s;let a=!1,_=!1,u=!1,h=!1;switch(e){case 64:break;case 65:case 66:a=!0;break;case 67:u=!0;break;case 68:case 69:a=!0,u=!0;break;case 70:_=!0;break;case 71:case 72:a=!0,_=!0;break;case 73:break;case 74:case 75:h=!0;break;default:throw new Error(`Unexpected chunk type ID: ${e}.`)}const c=[];for(let e=0;e<o;++e){const e=t.i16(),i=e<1,s=Math.abs(e),o=[];for(let e=0;e<s;++e){const i={index:t.u16()};o.push(i),a&&(i.tex_coords={x:t.u16()/255,y:t.u16()/255}),_&&t.seek(4),u&&(i.normal={x:t.u16()/255,y:t.u16()/255,z:t.u16()/255}),h&&t.seek(8),e>=2&&t.seek(2*r)}c.push(Object.assign(Object.assign({},n),{clockwise_winding:i,has_tex_coords:a,has_normal:u,vertices:o}))}return c}!function(t){t[t.Unknown=0]="Unknown",t[t.Null=1]="Null",t[t.Bits=2]="Bits",t[t.CachePolygonList=3]="CachePolygonList",t[t.DrawPolygonList=4]="DrawPolygonList",t[t.Tiny=5]="Tiny",t[t.Material=6]="Material",t[t.Vertex=7]="Vertex",t[t.Volume=8]="Volume",t[t.Strip=9]="Strip",t[t.End=10]="End"}(o||(o={}));const c=s.c.get("core/data_formats/parsing/ninja/xj");function f(t){t.seek(4);const e=t.u32(),i=t.u32(),n=t.u32(),s=t.u32(),r=t.u32(),o=t.u32(),a={type:"xj",vertices:[],meshes:[],collision_sphere_position:t.vec3_f32(),collision_sphere_radius:t.f32()};return i>=1&&(i>1&&c.warn(`Vertex info count of ${i} was larger than expected.`),a.vertices.push(...function(t,e){t.seek_start(e);const i=t.u16();t.seek(2);const n=t.u32(),s=t.u32(),r=t.u32(),o=[];for(let e=0;e<r;++e){t.seek_start(n+e*s);const r=t.vec3_f32();let a,_;switch(i){case 3:a=t.vec3_f32(),_=t.vec2_f32();break;case 4:break;case 5:t.seek(4),_=t.vec2_f32();break;case 6:a=t.vec3_f32();break;case 7:a=t.vec3_f32(),_=t.vec2_f32();break;default:c.warn(`Unknown vertex type ${i} with size ${s}.`)}o.push({position:r,normal:a,uv:_})}return o}(t,e))),a.meshes.push(...l(t,n,s)),a.meshes.push(...l(t,r,o)),a}function l(t,e,i){const n=[];for(let s=0;s<i;++s){t.seek_start(e+20*s);const i=t.u32(),r=t.u32(),o=t.u32(),a=t.u32(),_=d(t,i,r);t.seek_start(o);const u=t.u16_array(a);n.push({material_properties:_,indices:u})}return n}function d(t,e,i){const n={};for(let s=0;s<i;++s){switch(t.seek_start(e+16*s),t.u32()){case 2:n.alpha_src=t.u32(),n.alpha_dst=t.u32();break;case 3:n.texture_id=t.u32();break;case 5:n.diffuse_r=t.u8(),n.diffuse_g=t.u8(),n.diffuse_b=t.u8(),n.diffuse_a=t.u8()}}return n}i.d(e,"a",(function(){return p})),i.d(e,"b",(function(){return m})),i.d(e,"c",(function(){return y})),i.d(e,"d",(function(){return k})),i.d(e,"e",(function(){return b}));const p=2*Math.PI/65535,w=1296255566;function m(t){return"njcm"===t.type}class v{constructor(t,e,i,n,s,r){this.bone_cache=new Map,this._bone_count=-1,this.evaluation_flags=t,this.model=e,this.position=i,this.rotation=n,this.scale=s,this.children=r}bone_count(){if(-1===this._bone_count){const t=[0];this.get_bone_internal(this,1/0,t),this._bone_count=t[0]}return this._bone_count}get_bone(t){let e=this.bone_cache.get(t);return void 0===e&&(e=this.get_bone_internal(this,t,[0]),this.bone_cache.set(t,e||null)),e||void 0}get_bone_internal(t,e,i){if(!t.evaluation_flags.skip){const n=i[0]++;if(this.bone_cache.set(n,t),n===e)return t}if(!t.evaluation_flags.break_child_trace)for(const n of t.children){const t=this.get_bone_internal(n,e,i);if(t)return t}}}function y(t){return g(t,a,[])}function k(t){return g(t,f,void 0)}function b(t){return x(t,f,void 0)}function g(t,e,i){const s=Object(n.a)(t).filter(t=>t.type===w),r=[];for(const t of s)r.push(...x(t.data,e,i));return r}function x(t,e,i){const n=t.u32(),s=0!=(1&n),r=0!=(2&n),o=0!=(4&n),a=0!=(8&n),_=0!=(16&n),u=0!=(32&n),h=0!=(64&n),c=0!=(128&n),f=t.u32(),l=t.vec3_f32(),d={x:t.i32()*p,y:t.i32()*p,z:t.i32()*p},w=t.vec3_f32(),m=t.u32(),y=t.u32();let k,b,g;return f&&(t.seek_start(f),k=e(t,i)),m?(t.seek_start(m),b=x(t,e,i)):b=[],y?(t.seek_start(y),g=x(t,e,i)):g=[],[new v({no_translate:s,no_rotate:r,no_scale:o,hidden:a,break_child_trace:_,zxy_rotation_order:u,skip:h,shape_skip:c},k,l,d,w,b),...g]}},tyuj:function(t,e,i){"use strict";i.r(e);var n=i("NRxM"),s=i("bcBH"),r=i("VwSi"),o=i("kwt4");class a{constructor(t,e,i,n){this.name=t,this.head_style_count=e,this.hair_styles_count=i,this.hair_styles_with_accessory=n}}class _{constructor(t,e){this.id=t,this.name=e}}var u=i("Sa3/"),h=i("ouMO"),c=i("7CyS"),f=i("yub1"),l=i("kcKQ"),d=i("rwco");i.d(e,"Model3DStore",(function(){return m}));var p=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function o(t){try{_(n.next(t))}catch(t){r(t)}}function a(t){try{_(n.throw(t))}catch(t){r(t)}}function _(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}_((n=n.apply(t,e||[])).next())}))};const w=d.c.get("viewer/stores/ModelStore");class m extends l.a{constructor(t){super(),this.asset_loader=t,this._current_model=Object(h.e)(void 0),this._current_nj_data=Object(h.e)(void 0),this._current_xvm=Object(h.e)(void 0),this._show_skeleton=Object(h.e)(!1),this._current_animation=Object(h.e)(void 0),this._current_nj_motion=Object(h.e)(void 0),this._animation_playing=Object(h.e)(!0),this._animation_frame_rate=Object(h.e)(c.a),this._animation_frame=Object(h.e)(0),this.models=[new a("HUmar",1,10,new Set([6])),new a("HUnewearl",1,10,new Set),new a("HUcast",5,0,new Set),new a("HUcaseal",5,0,new Set),new a("RAmar",1,10,new Set([0,1,2,3,4,5,6,7,8,9])),new a("RAmarl",1,10,new Set([0,1,2,3,4,5,6,7,8,9])),new a("RAcast",5,0,new Set),new a("RAcaseal",5,0,new Set),new a("FOmar",1,10,new Set([0,1,2,3,4,5,6,7,8,9])),new a("FOmarl",1,10,new Set([0,1,2,3,4,5,6,7,8,9])),new a("FOnewm",1,10,new Set([0,1,2,3,4,5,6,7,8,9])),new a("FOnewearl",1,10,new Set([0,1,2,3,4,5,6,7,8,9]))],this.animations=new Array(572).fill(void 0).map((t,e)=>new _(e,`Animation ${e+1}`)),this.current_model=this._current_model,this.current_nj_data=this._current_nj_data,this.current_xvm=this._current_xvm,this.show_skeleton=this._show_skeleton,this.current_animation=this._current_animation,this.current_nj_motion=this._current_nj_motion,this.animation_playing=this._animation_playing,this.animation_frame_rate=this._animation_frame_rate,this.animation_frame=this._animation_frame,this.animation_frame_count=this.current_nj_motion.map(t=>t?t.frame_count:0),this.set_current_model=t=>{this._current_model.val=t},this.clear_current_model=()=>{this._current_model.val=void 0},this.set_show_skeleton=t=>{this._show_skeleton.val=t},this.set_current_animation=t=>{this._current_animation.val=t},this.clear_current_animation=()=>{this._current_animation.val=void 0},this.set_animation_playing=t=>{this._animation_playing.val=t},this.set_animation_frame_rate=t=>{this._animation_frame_rate.val=t},this.set_animation_frame=t=>{this._animation_frame.val=t},this.load_file=t=>p(this,void 0,void 0,(function*(){try{const e=yield Object(u.a)(t),i=new n.a(e,s.a.Little);if(t.name.endsWith(".nj")){this.clear_current_model();const t=Object(o.c)(i)[0];this.set_current_nj_data({nj_object:t,bone_count:t.bone_count(),has_skeleton:!0})}else if(t.name.endsWith(".xj")){this.clear_current_model();const t=Object(o.d)(i)[0];this.set_current_nj_data({nj_object:t,bone_count:0,has_skeleton:!1})}else if(t.name.endsWith(".njm")){this.clear_current_animation(),this._current_nj_motion.val=void 0;const t=this.current_nj_data.val;t&&(this.set_animation_playing(!0),this._current_nj_motion.val=Object(r.c)(i,t.bone_count))}else t.name.endsWith(".xvm")?this.current_model&&(this._current_xvm.val=Object(f.a)(i)):w.error(`Unknown file extension in filename "${t.name}".`)}catch(t){w.error("Couldn't read file.",t)}})),this.load_model=t=>p(this,void 0,void 0,(function*(){if(this.clear_current_animation(),t)try{const e=yield this.asset_loader.load_geometry(t);this.set_current_nj_data({nj_object:e,bone_count:t?64:e.bone_count(),has_skeleton:!0})}catch(e){w.error(`Couldn't load model for ${t.name}.`),this._current_nj_data.val=void 0}else this._current_nj_data.val=void 0})),this.load_animation=t=>p(this,void 0,void 0,(function*(){const e=this.current_nj_data.val;if(e&&t)try{this._current_nj_motion.val=yield this.asset_loader.load_animation(t.id,e.bone_count),this.set_animation_playing(!0)}catch(e){w.error(`Couldn't load animation "${t.name}".`),this._current_nj_motion.val=void 0}else this._current_nj_motion.val=void 0})),this.disposables(this.current_model.observe(({value:t})=>this.load_model(t)),this.current_animation.observe(({value:t})=>this.load_animation(t)))}set_current_nj_data(t){this._current_xvm.val=void 0,this._current_nj_data.val=t}}},yub1:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("9Ykw");const s=i("rwco").c.get("core/data_formats/parsing/ninja/texture"),r=1213027928,o=1414682200;function a(t){const e=Object(n.a)(t),i=e.find(t=>t.type===r),a=i&&function(t){return{texture_count:t.u16()}}(i.data),_=e.filter(t=>t.type===o).map(t=>(function(t){const e=t.u32(),i=t.u32(),n=t.u32(),s=t.u16(),r=t.u16(),o=t.u32();return t.seek(36),{id:n,format:[e,i],width:s,height:r,size:o,data:t.array_buffer(o)}})(t.data));return a&&a.texture_count!==_.length&&s.warn(`Found ${_.length} textures instead of ${a.texture_count} as defined in the header.`),{textures:_}}}}]);
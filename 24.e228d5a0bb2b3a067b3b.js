(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{547:function(t,e,n){"use strict";n.d(e,"a",(function(){return _})),n.d(e,"b",(function(){return r}));var s=n(133),i=n(545);const _=30;function r(t,e){const n=e.interpolation===i.a.Spline?s.InterpolateSmooth:s.InterpolateLinear,r=[];return e.motion_data.forEach((e,a)=>{const o=t.get_bone(a);o&&e.tracks.forEach(({type:t,keyframes:e})=>{const c=[],l=[];for(const n of e)if(c.push(n.frame/_),t===i.b.Rotation){const t=o.evaluation_flags.zxy_rotation_order?"ZXY":"ZYX",e=(new s.Quaternion).setFromEuler(new s.Euler(n.value.x,n.value.y,n.value.z,t));l.push(e.x,e.y,e.z,e.w)}else l.push(n.value.x,n.value.y,n.value.z);if(t===i.b.Rotation)r.push(new s.QuaternionKeyframeTrack(`.bones[${a}].quaternion`,c,l,n));else{const e=t===i.b.Position?`.bones[${a}].position`:`.bones[${a}].scale`;r.push(new s.VectorKeyframeTrack(e,c,l,n))}})}),new s.AnimationClip("Animation",(e.frame_count-1)/_,r).optimize()}},633:function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"h",(function(){return _})),n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return a})),n.d(e,"k",(function(){return o})),n.d(e,"l",(function(){return c})),n.d(e,"j",(function(){return l})),n.d(e,"i",(function(){return h})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"d",(function(){return y})),n.d(e,"c",(function(){return m}));class s{constructor(t){var e,n,s,i,_;this.name=t.name,this.body_style_count=null!=(e=t.body_style_count)?e:1,this.head_style_count=t.head_style_count,this.hair_style_count=t.hair_style_count,this.hair_styles_with_accessory=t.hair_styles_with_accessory,this.body_tex_ids=null!=(n=t.body_tex_ids)?n:[],this.head_tex_ids=null!=(s=t.head_tex_ids)?s:[],this.hair_tex_ids=null!=(i=t.hair_tex_ids)?i:[],this.accessory_tex_ids=null!=(_=t.accessory_tex_ids)?_:[]}}const i=new s({name:"HUmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([6])}),_=new s({name:"HUnewearl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set}),r=new s({name:"HUcast",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),a=new s({name:"HUcaseal",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),o=new s({name:"RAmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),c=new s({name:"RAmarl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),l=new s({name:"RAcast",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),h=new s({name:"RAcaseal",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),u=new s({name:"FOmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),d=new s({name:"FOmarl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),y=new s({name:"FOnewm",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),m=new s({name:"FOnewearl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])})},903:function(t,e,n){"use strict";n.r(e);var s=n(57),i=n(633),_=n(14);class r{constructor(t,e){this.id=t,this.name=e}}var a=n(547),o=n(30),c=n(23),l=n(35),h=n(63);n.d(e,"ModelStore",(function(){return y}));var u=function(t,e,n,s){return new(n||(n=Promise))((function(i,_){function r(t){try{o(s.next(t))}catch(t){_(t)}}function a(t){try{o(s.throw(t))}catch(t){_(t)}}function o(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}o((s=s.apply(t,e||[])).next())}))};const d=c.a.get("viewer/stores/ModelStore");class y extends s.a{constructor(t,e,n){super(),this.asset_loader=e,this.random=n,this._current_character_class=Object(_.e)(void 0),this._current_section_id=Object(_.e)(void 0),this._current_body=Object(_.e)(void 0),this._current_animation=Object(_.e)(void 0),this._current_nj_object=Object(_.e)(void 0),this._current_textures=Object(_.c)(),this._current_nj_motion=Object(_.e)(void 0),this._show_skeleton=Object(_.e)(!1),this._animation_playing=Object(_.e)(!0),this._animation_frame_rate=Object(_.e)(a.a),this._animation_frame=Object(_.e)(0),this.character_classes=[i.g,i.h,i.f,i.e,i.k,i.l,i.j,i.i,i.a,i.b,i.d,i.c],this.current_character_class=this._current_character_class,this.current_section_id=this._current_section_id,this.current_body=this._current_body,this.animations=new Array(572).fill(void 0).map((t,e)=>new r(e,`Animation ${e+1}`)),this.current_animation=this._current_animation,this.current_nj_object=this._current_nj_object,this.current_textures=this._current_textures,this.current_nj_motion=this._current_nj_motion,this.animation_frame_count=this.current_nj_motion.map(t=>t?t.frame_count:0),this.show_skeleton=this._show_skeleton,this.animation_playing=this._animation_playing,this.animation_frame_rate=this._animation_frame_rate,this.animation_frame=this._animation_frame,this.set_current_character_class=t=>{var e;if(this._current_character_class.val!==t){if(null==t)this.set_current_body(void 0);else{const n=this.current_body.val;(void 0===n||n>=(null===(e=t)||void 0===e?void 0:e.body_style_count))&&this.set_current_body(t.body_style_count-1)}this._current_character_class.val=t,null==this.current_animation.val&&this.set_current_nj_motion(void 0)}},this.set_current_section_id=t=>{this._current_section_id.val=t},this.set_current_body=t=>{this._current_body.val=t},this.set_current_animation=t=>{this._current_animation.val!==t&&(this._current_animation.val=t)},this.set_current_nj_object=t=>{this.set_current_character_class(void 0),this.set_current_animation(void 0),this.set_current_textures([]),this.set_current_nj_motion(void 0),this._current_nj_object.val=t},this.set_current_textures=t=>{this._current_textures.val=t},this.set_current_nj_motion=t=>{this.set_current_animation(void 0),this._current_nj_motion.val=t},this.set_show_skeleton=t=>{this._show_skeleton.val=t},this.set_animation_playing=t=>{this._animation_playing.val=t},this.set_animation_frame_rate=t=>{this._animation_frame_rate.val=t},this.set_animation_frame=t=>{this._animation_frame.val=t},this.load_character_class_model=()=>u(this,void 0,void 0,(function*(){const t=this.current_character_class.val;if(null==t)return;const e=this.current_section_id.val;if(null==e)return;const n=this.current_body.val;if(null!=n)try{const s=yield this.asset_loader.load_geometry(t);this._current_textures.val=yield this.asset_loader.load_textures(t,e,n),this._current_nj_object.val=s}catch(e){d.error(`Couldn't load model for ${t.name}.`),this._current_nj_object.val=void 0}})),this.load_animation=()=>u(this,void 0,void 0,(function*(){const t=this._current_nj_object.val,e=this.current_animation.val;if(t&&e)try{this._current_nj_motion.val=yield this.asset_loader.load_animation(e.id,64),this.set_animation_playing(!0)}catch(t){d.error(`Couldn't load animation "${e.name}".`,t),this._current_nj_motion.val=void 0}else this._current_nj_motion.val=void 0})),this.disposables(this.current_character_class.observe(this.load_character_class_model),this.current_section_id.observe(this.load_character_class_model),this.current_body.observe(this.load_character_class_model),this.current_animation.observe(this.load_animation)),this.disposables(t.bind_parameter(l.b.Viewer,"/models","model",this.current_character_class.map(t=>void 0===t?void 0:t.name)),t.bind_parameter(l.b.Viewer,"/models","section_id",this.current_section_id.map(t=>void 0===t?void 0:o.e[t])),t.bind_parameter(l.b.Viewer,"/models","body",this.current_body.map(t=>void 0===t?void 0:String(t+1))));const s=t.get_parameter(l.b.Viewer,"/models","model");let c=this.character_classes.find(t=>t.name===s);null==c&&(c=n.sample_array(this.character_classes));const y=t.get_parameter(l.b.Viewer,"/models","body");let m=null==y?void 0:parseInt(y,10);null!=m&&Number.isInteger(m)?m--:m=n.integer(0,c.body_style_count);const b=t.get_parameter(l.b.Viewer,"/models","section_id"),v=void 0===b?void 0:Object(h.b)(o.e,b);this._current_section_id.val=null!=v?v:n.sample_array(o.f),this._current_body.val=m,this._current_character_class.val=c}}}}]);
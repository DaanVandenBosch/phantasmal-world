(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"6cU9":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var r=s("FXpb"),i=(s("+Mcu"),s("ouMO")),n=s("QmPX");class a extends n.a{constructor(e,t){super(t),this.element=Object(r.n)({className:"core_FileButton core_Button"}),this.input=Object(r.m)({className:"core_FileButton_input core_Button_inner"}),this._files=Object(i.e)([]),this.files=this._files,this.input.type="file",this.input.onchange=()=>{this.input.files&&this.input.files.length?this._files.val=[...this.input.files]:this._files.val=[]},t&&t.accept&&(this.input.accept=t.accept);const s=Object(r.r)({className:"core_FileButton_inner core_Button_inner"});t&&null!=t.icon_left&&s.append(Object(r.r)({className:"core_FileButton_left core_Button_left"},Object(r.k)(t.icon_left))),s.append(Object(r.r)({className:"core_Button_center"},e)),this.element.append(s,this.input),this.disposables(this.enabled.observe(({value:e})=>{this.input.disabled=!e,e?this.element.classList.remove("disabled"):this.element.classList.add("disabled")})),this.finalize_construction()}click(){this.input.click()}}},Ftn7:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("pVCM"),i=s("Womt");r.a.install({THREE:Object.assign(Object.assign({},i),{MOUSE:Object.assign(Object.assign({},i.MOUSE),{LEFT:i.MOUSE.RIGHT,RIGHT:i.MOUSE.LEFT})})});class n{constructor(e){this._debug=!1,this.scene=new i.Scene,this.light_holder=new i.Group,this.render_scheduled=!1,this.animation_frame_handle=void 0,this.light=new i.HemisphereLight(16777215,5263440,1),this.controls_clock=new i.Clock,this.size=new i.Vector2(0,0),this.schedule_render=()=>{this.render_scheduled=!0},this.on_mouse_down=e=>{e.currentTarget&&e.currentTarget.focus()},this.call_render=()=>{const e=this.controls.update(this.controls_clock.getDelta()),t=this.render_scheduled||e;this.render_scheduled=!1,t&&this.render(),this.animation_frame_handle=requestAnimationFrame(this.call_render)},this.renderer=e,this.renderer.domElement.tabIndex=0,this.renderer.domElement.addEventListener("mousedown",this.on_mouse_down),this.renderer.domElement.style.outline="none",this.scene.background=new i.Color(1579032),this.light_holder.add(this.light),this.scene.add(this.light_holder)}get debug(){return this._debug}set debug(e){this._debug=e}get canvas_element(){return this.renderer.domElement}set_size(e,t){this.size.set(e,t),this.renderer.setSize(e,t),this.schedule_render()}pointer_pos_to_device_coords(e){e.set(e.x/this.size.width*2-1,e.y/this.size.height*-2+1)}start_rendering(){this.schedule_render(),this.animation_frame_handle=requestAnimationFrame(this.call_render)}stop_rendering(){null!=this.animation_frame_handle&&(cancelAnimationFrame(this.animation_frame_handle),this.animation_frame_handle=void 0)}reset_camera(e,t){this.controls.setLookAt(e.x,e.y,e.z,t.x,t.y,t.z)}dispose(){this.renderer.dispose(),this.controls.dispose()}init_camera_controls(){this.controls=new r.a(this.camera,this.renderer.domElement),this.controls.dampingFactor=1,this.controls.draggingDampingFactor=1}render(){this.renderer.render(this.scene,this.camera)}}},KUR2:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("nN8q"),i=s("FXpb");class n extends r.a{constructor(e){super(),this.renderer=e,this.element=Object(i.i)({className:"core_RendererWidget"}),this.element.append(e.canvas_element),this.disposable(e),this.finalize_construction()}start_rendering(){this.renderer.start_rendering()}stop_rendering(){this.renderer.stop_rendering()}resize(e,t){return super.resize(e,t),this.renderer.set_size(e,t),this}}},Za3H:function(e,t,s){"use strict";s.r(t);var r=s("FXpb"),i=s("nN8q"),n=s("6cU9"),a=s("w6HN"),o=s("KUR2"),h=s("Womt"),c=s("Ftn7"),l=s("Tpfs"),d=s("iR5r");const u=s("rwco").c.get("viewer/rendering/TextureRenderer");class _ extends c.a{constructor(e,t){super(e),this.disposer=new l.a,this.quad_meshes=[],this.camera=new h.OrthographicCamera(-400,400,300,-300,1,10),this.disposer.add_all(t.current_xvm.observe(({value:e})=>{this.scene.remove(...this.quad_meshes),e&&this.render_textures(e),this.reset_camera(new h.Vector3(0,0,5),new h.Vector3),this.schedule_render()})),this.init_camera_controls(),this.controls.dollySpeed=-1,this.controls.azimuthRotateSpeed=0,this.controls.polarRotateSpeed=0}set_size(e,t){this.camera.left=-Math.floor(e/2),this.camera.right=Math.ceil(e/2),this.camera.top=Math.floor(t/2),this.camera.bottom=-Math.ceil(t/2),this.camera.updateProjectionMatrix(),super.set_size(e,t)}dispose(){super.dispose(),this.disposer.dispose()}render_textures(e){let t=10*(e.textures.length-1),s=0;for(const r of e.textures)t+=r.width,s=Math.max(s,r.height);let r=-Math.floor(t/2);const i=-Math.floor(s/2);for(const t of e.textures){let e;try{e=Object(d.a)(t)}catch(e){u.warn("Couldn't convert XVM texture.",e)}const n=new h.Mesh(this.create_quad(r,i+Math.floor((s-t.height)/2),t.width,t.height),e?new h.MeshBasicMaterial({map:e,transparent:!0}):new h.MeshBasicMaterial({color:16711935}));this.quad_meshes.push(n),this.scene.add(n),r+=10+t.width}}create_quad(e,t,s,r){const i=new h.PlaneGeometry(s,r,1,1);return i.faceVertexUvs=[[[new h.Vector2(0,0),new h.Vector2(0,1),new h.Vector2(1,0)],[new h.Vector2(0,1),new h.Vector2(1,1),new h.Vector2(1,0)]]],i.translate(e+s/2,t+r/2,-5),i}}var p=s("4SjJ");s.d(t,"TextureView",(function(){return m}));class m extends i.a{constructor(e,t,s){super(),this.element=Object(r.i)({className:"viewer_TextureView"}),this.open_file_button=new n.a("Open file...",{icon_left:r.a.File,accept:".xvm"}),this.tool_bar=this.disposable(new a.a(this.open_file_button)),this.renderer_view=this.disposable(new o.a(new _(s,t))),this.element.append(this.tool_bar.element,this.renderer_view.element),this.disposable(this.open_file_button.files.observe(({value:e})=>{e.length&&t.load_file(e[0])})),this.renderer_view.start_rendering(),this.disposable(e.tool.observe(({value:e})=>{e===p.b.Viewer?this.renderer_view.start_rendering():this.renderer_view.stop_rendering()})),this.finalize_construction()}resize(e,t){return super.resize(e,t),this.renderer_view.resize(e,Math.max(0,t-this.tool_bar.height)),this}}},iR5r:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n}));var r=s("Womt");function i(e){return e.textures.map(n)}function n(e){let t,s;switch(e.format[1]){case 6:t=r.RGBA_S3TC_DXT1_Format,s=e.width*e.height/2;break;case 7:t=r.RGBA_S3TC_DXT3_Format,s=e.width*e.height;break;default:throw new Error(`Format ${e.format.join(", ")} not supported.`)}const i=new r.CompressedTexture([{data:new Uint8Array(e.data,0,s),width:e.width,height:e.height}],e.width,e.height,t);return i.minFilter=r.LinearFilter,i.wrapS=r.MirroredRepeatWrapping,i.wrapT=r.MirroredRepeatWrapping,i.needsUpdate=!0,i}},w6HN:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var r=s("TRid"),i=(s("IQIM"),s("sDu+")),n=s("FXpb");class a extends r.a{constructor(e,...t){super(e instanceof r.a?void 0:e),this.element=Object(n.i)({className:"core_ToolBar"}),this.height=33,this.element.style.height=`${this.height}px`,this.children=e instanceof r.a?[e,...t]:t;for(const e of this.children)if(this.disposable(e),e instanceof i.a&&e.label){const t=Object(n.i)({className:"core_ToolBar_group"});"left"===e.preferred_label_position||"top"===e.preferred_label_position?t.append(e.label.element,e.element):t.append(e.element,e.label.element),this.element.append(t)}else this.element.append(e.element);this.finalize_construction()}set_enabled(e){super.set_enabled(e);for(const t of this.children)t.enabled.val=e}}}}]);
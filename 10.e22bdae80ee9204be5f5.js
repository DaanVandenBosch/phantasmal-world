(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{453:function(t,e,s){"use strict";function i(t,...e){return{success:!0,value:t,problems:e}}function n(...t){return{success:!1,problems:t}}function r(t,e){return{severity:t,ui_message:e}}function o(t){if(t.success)return t.value;throw new Error(t.problems.join("\n"))}s.d(e,"d",(function(){return i})),s.d(e,"b",(function(){return n})),s.d(e,"c",(function(){return r})),s.d(e,"e",(function(){return o})),s.d(e,"a",(function(){return a}));class a{constructor(t){this.logger=t,this.problems=[]}add_problem(t,e,s,i){return this.logger.log(t,null!=s?s:e,i),this.problems.push({severity:t,ui_message:e}),this}add_result(t){return this.problems.push(...t.problems),this}success(t){return i(t,...this.problems)}failure(){return n(...this.problems)}}},457:function(t,e,s){"use strict";var i;s.d(e,"a",(function(){return i})),function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"}(i||(i={}))},464:function(t,e,s){"use strict";s.d(e,"a",(function(){return r})),s.d(e,"b",(function(){return o}));const i=2*Math.PI/65536,n=65536/(2*Math.PI);function r(t){return t*i}function o(t){return Math.round(t*n)}},466:function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));var i=s(457),n=s(550);class r extends n.a{constructor(t,e){super(e),this.endianness=t}get endianness(){return this.little_endian?i.a.Little:i.a.Big}set endianness(t){this.little_endian=t===i.a.Little}u8(){this.check_size(1);const t=this.dv.getUint8(this.absolute_position);return this._position++,t}u16(){this.check_size(2);const t=this.dv.getUint16(this.absolute_position,this.little_endian);return this._position+=2,t}u32(){this.check_size(4);const t=this.dv.getUint32(this.absolute_position,this.little_endian);return this._position+=4,t}i8(){this.check_size(1);const t=this.dv.getInt8(this.absolute_position);return this._position++,t}i16(){this.check_size(2);const t=this.dv.getInt16(this.absolute_position,this.little_endian);return this._position+=2,t}i32(){this.check_size(4);const t=this.dv.getInt32(this.absolute_position,this.little_endian);return this._position+=4,t}f32(){this.check_size(4);const t=this.dv.getFloat32(this.absolute_position,this.little_endian);return this._position+=4,t}u8_array(t){this.check_size(t);const e=[];for(let s=0;s<t;++s)e.push(this.dv.getUint8(this.absolute_position)),this._position++;return e}u16_array(t){this.check_size(2*t);const e=[];for(let s=0;s<t;++s)e.push(this.dv.getUint16(this.absolute_position,this.little_endian)),this._position+=2;return e}u32_array(t){this.check_size(4*t);const e=[];for(let s=0;s<t;++s)e.push(this.dv.getUint32(this.absolute_position,this.little_endian)),this._position+=4;return e}i32_array(t){this.check_size(4*t);const e=[];for(let s=0;s<t;++s)e.push(this.dv.getInt32(this.absolute_position,this.little_endian)),this._position+=4;return e}array_buffer(t=this.size-this.position){this.check_size(t);const e=this.backing_buffer.slice(this.absolute_position,this.absolute_position+t);return this._position+=t,e}copy_to_uint8_array(t,e=this.size-this.position){return this.check_size(e),t.set(new Uint8Array(this.backing_buffer,this.absolute_position,e)),this._position+=e,this}write_u8(t){return this.check_size(1),this.dv.setUint8(this.absolute_position,t),this._position++,this}write_u16(t){return this.check_size(2),this.dv.setUint16(this.absolute_position,t,this.little_endian),this._position+=2,this}write_u32(t){return this.check_size(4),this.dv.setUint32(this.absolute_position,t,this.little_endian),this._position+=4,this}write_i8(t){return this.check_size(1),this.dv.setInt8(this.absolute_position,t),this._position++,this}write_i16(t){return this.check_size(2),this.dv.setInt16(this.absolute_position,t,this.little_endian),this._position+=2,this}write_i32(t){return this.check_size(4),this.dv.setInt32(this.absolute_position,t,this.little_endian),this._position+=4,this}write_f32(t){return this.check_size(4),this.dv.setFloat32(this.absolute_position,t,this.little_endian),this._position+=4,this}write_u8_array(t){return this.check_size(t.length),new Uint8Array(this.backing_buffer,this.absolute_position,t.length).set(new Uint8Array(t)),this._position+=t.length,this}write_cursor(t){const e=t.size-t.position;return this.check_size(e),t.copy_to_uint8_array(new Uint8Array(this.backing_buffer,this.absolute_position,e),e),this._position+=e,this}}class o extends r{constructor(t,e,s=0,i=t.byteLength-s){super(e,s),this._size=i,this.backing_buffer=t,this.dv=new DataView(t,0,t.byteLength)}get size(){return this._size}set size(t){if(t>this.backing_buffer.byteLength-this.offset)throw new Error(`Size ${t} is out of bounds.`);this._size=t}take(t){const e=this.offset+this.position,s=new o(this.backing_buffer,this.endianness,e,t);return this._position+=t,s}}},491:function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return r})),s.d(e,"c",(function(){return o}));var i=s(464);var n,r;function o(t,e){return 1296321870===t.u32()?function(t,e){const s=t.u32();return a(t.take(s),e)}(t,e):(t.seek_start(0),function(t,e){t.seek_end(16);const s=t.u32();t.seek_start(s);const i=t.u32();return t.seek_start(i),function(t,e){t.seek(4);const s=t.u32();return t.seek_start(s),a(t,e)}(t,e)}(t,e))}function a(t,e){let s=t.u32();const i=t.u32(),n=t.u16(),o=t.u16(),a=(192&o)>>6,_=15&o,h=[];for(let o=0;o<e;o++){t.seek_start(s),s=s+=8*_;const e={tracks:[]};h.push(e);const o=[],a=[];for(let e=0;e<_;e++)o.push(t.u32());for(let e=0;e<_;e++){const e=t.u32();a.push(e)}if(1&n){t.seek_start(o.shift());const s=a.shift();s&&e.tracks.push({type:r.Position,keyframes:c(t,s)})}if(2&n){t.seek_start(o.shift());const s=a.shift();s&&e.tracks.push({type:r.Rotation,keyframes:u(t,s,i)})}if(4&n){t.seek_start(o.shift());const s=a.shift();s&&e.tracks.push({type:r.Scale,keyframes:c(t,s)})}}return{motion_data:h,frame_count:i,type:n,interpolation:a,element_count:_}}function c(t,e){const s=[];for(let i=0;i<e;++i)s.push({frame:t.u32(),value:t.vec3_f32()});return s}function u(t,e,s){const n=[],r=t.position;for(let s=0;s<e;++s)n.push({frame:t.u16(),value:{x:Object(i.a)(t.u16()),y:Object(i.a)(t.u16()),z:Object(i.a)(t.u16())}});let o=-1;for(const{frame:i}of n){if(i<o||i>=s)return t.seek_start(r),_(t,e);o=i}return n}function _(t,e){const s=[];for(let n=0;n<e;++n)s.push({frame:t.u32(),value:{x:Object(i.a)(t.i32()),y:Object(i.a)(t.i32()),z:Object(i.a)(t.i32())}});return s}!function(t){t[t.Linear=0]="Linear",t[t.Spline=1]="Spline",t[t.UserFunction=2]="UserFunction"}(n||(n={})),function(t){t[t.Position=0]="Position",t[t.Rotation=1]="Rotation",t[t.Scale=2]="Scale"}(r||(r={}))},512:function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"b",(function(){return c}));var i=s(453),n=s(24),r=s(28);const o=n.a.get("core/data_formats/parsing/iff");function a(t,e=!1){return u(t,e,[],(t,e,s)=>({type:e,data:t.take(s)}))}function c(t,e=!1){return u(t,e,[],(t,e,s)=>({type:e,size:s}))}function u(t,e,s,n){const a=new i.a(o);let c=!1;for(;t.bytes_left>=8;){const i=t.u32(),o=t.position,u=t.u32();if(u>t.bytes_left){c=!0,e||a.add_problem(0===s.length?r.b.Error:r.b.Warning,"Invalid IFF format.",`Size ${u} was too large (only ${t.bytes_left} bytes left) at position ${o}.`);break}s.push(n(t,i,u))}return c&&0===s.length?a.failure():a.success(s)}},513:function(t,e,s){"use strict";s.d(e,"a",(function(){return b})),s.d(e,"b",(function(){return k})),s.d(e,"c",(function(){return g})),s.d(e,"d",(function(){return m}));var i=s(512),n=s(24);const r=n.a.get("core/data_formats/parsing/ninja/njcm");var o;function a(t,e){const s=t.u32(),i=t.u32(),n=t.vec3_f32(),r=t.f32(),a=[],u=[];if(s){t.seek_start(s);for(const s of c(t,e,!0))if(s.type===o.Vertex)for(const t of s.vertices)a[t.index]={position:t.position,normal:t.normal,bone_weight:t.bone_weight,bone_weight_status:t.bone_weight_status,calc_continue:t.calc_continue}}if(i){t.seek_start(i);let s=void 0,n=void 0,r=void 0;for(const i of c(t,e,!1))switch(i.type){case o.Bits:n=i.src_alpha,r=i.dst_alpha;break;case o.Tiny:s=i.texture_id;break;case o.Material:n=i.src_alpha,r=i.dst_alpha;break;case o.Strip:for(const t of i.triangle_strips)t.texture_id=s,t.src_alpha=n,t.dst_alpha=r;u.push(...i.triangle_strips)}}return{type:"njcm",vertices:a,meshes:u,collision_sphere_center:n,collision_sphere_radius:r}}function c(t,e,s){const i=[];let n=!0;for(;n;){const a=t.u8(),h=t.u8(),l=t.position;let d=0;if(0===a)i.push({type:o.Null,type_id:a});else if(1<=a&&a<=3)i.push({type:o.Bits,type_id:a,src_alpha:h>>>3&7,dst_alpha:7&h});else if(4===a){const s=h,r=t.position;i.push({type:o.CachePolygonList,type_id:a,cache_index:s,offset:r}),e[s]=r,n=!1}else if(5===a){const n=h,r=e[n];null!=r&&(t.seek_start(r),i.push(...c(t,e,s))),i.push({type:o.DrawPolygonList,type_id:a,cache_index:n})}else if(8<=a&&a<=9){d=2;const e=t.u16();i.push({type:o.Tiny,type_id:a,flip_u:0!=(128&a),flip_v:0!=(64&a),clamp_u:0!=(32&a),clamp_v:0!=(16&a),mipmap_d_adjust:15&a,filter_mode:e>>>14,super_sample:0!=(64&e),texture_id:8191&e})}else if(17<=a&&a<=31){let e,s,n;d=2+2*t.u16(),0!=(1&h)&&(e={b:t.u8()/255,g:t.u8()/255,r:t.u8()/255,a:t.u8()/255}),0!=(2&h)&&(s={b:t.u8()/255,g:t.u8()/255,r:t.u8()/255,a:t.u8()/255}),0!=(4&h)&&(n={b:t.u8(),g:t.u8(),r:t.u8(),e:t.u8()}),i.push({type:o.Material,type_id:a,src_alpha:h>>>3&7,dst_alpha:7&h,diffuse:e,ambient:s,specular:n})}else 32<=a&&a<=50?(d=2+4*t.u16(),i.push({type:o.Vertex,type_id:a,vertices:u(t,a,h)})):56<=a&&a<=58?(d=2+2*t.u16(),i.push({type:o.Volume,type_id:a})):64<=a&&a<=75?(d=2+2*t.u16(),i.push({type:o.Strip,type_id:a,triangle_strips:_(t,a,h)})):255===a?(d=s?2:0,i.push({type:o.End,type_id:a}),n=!1):(d=2+2*t.u16(),i.push({type:o.Unknown,type_id:a}),r.warn(`Unknown chunk type ${a} at offset ${l}.`));t.seek_start(l+d)}return i}function u(t,e,s){if(e<32||e>50)return r.warn(`Unknown vertex chunk type ${e}.`),[];const i=3&s,n=0!=(128&s),o=t.u16(),a=t.u16(),c=[];for(let s=0;s<a;++s){const r={index:o+s,position:t.vec3_f32(),bone_weight:1,bone_weight_status:i,calc_continue:n};if(32===e)t.seek(4);else if(33===e)t.seek(4),r.normal=t.vec3_f32(),t.seek(4);else if(35<=e&&e<=40)37===e?(r.index=o+t.u16(),r.bone_weight=t.u16()/255):t.seek(4);else if(41<=e&&e<=47)r.normal=t.vec3_f32(),e>=42&&(44===e?(r.index=o+t.u16(),r.bone_weight=t.u16()/255):t.seek(4));else if(48<=e&&e<=50){const s=t.u32();r.normal={x:(s>>20&1023)/1023,y:(s>>10&1023)/1023,z:(1023&s)/1023},e>=49&&t.seek(4)}c.push(r)}return c}function _(t,e,s){const i={ignore_light:0!=(1&s),ignore_specular:0!=(2&s),ignore_ambient:0!=(4&s),use_alpha:0!=(8&s),double_side:0!=(16&s),flat_shading:0!=(32&s),environment_mapping:0!=(64&s)},n=t.u16(),r=n>>>14,o=16383&n;let a=!1,c=!1,u=!1,_=!1;switch(e){case 64:break;case 65:case 66:a=!0;break;case 67:u=!0;break;case 68:case 69:a=!0,u=!0;break;case 70:c=!0;break;case 71:case 72:a=!0,c=!0;break;case 73:break;case 74:case 75:_=!0;break;default:throw new Error(`Unexpected chunk type ID: ${e}.`)}const h=[];for(let e=0;e<o;++e){const e=t.i16(),s=e<1,n=Math.abs(e),o=[];for(let e=0;e<n;++e){const s={index:t.u16()};o.push(s),a&&(s.tex_coords={x:t.u16()/255,y:t.u16()/255}),c&&t.seek(4),u&&(s.normal={x:t.u16()/255,y:t.u16()/255,z:t.u16()/255}),_&&t.seek(8),e>=2&&t.seek(2*r)}h.push(Object.assign(Object.assign({},i),{clockwise_winding:s,has_tex_coords:a,has_normal:u,vertices:o}))}return h}!function(t){t[t.Unknown=0]="Unknown",t[t.Null=1]="Null",t[t.Bits=2]="Bits",t[t.CachePolygonList=3]="CachePolygonList",t[t.DrawPolygonList=4]="DrawPolygonList",t[t.Tiny=5]="Tiny",t[t.Material=6]="Material",t[t.Vertex=7]="Vertex",t[t.Volume=8]="Volume",t[t.Strip=9]="Strip",t[t.End=10]="End"}(o||(o={}));const h=n.a.get("core/data_formats/parsing/ninja/xj");function l(t){t.seek(4);const e=t.u32(),s=t.u32(),i=t.u32(),n=t.u32(),r=t.u32(),o=t.u32(),a={type:"xj",vertices:[],meshes:[],collision_sphere_position:t.vec3_f32(),collision_sphere_radius:t.f32()};return s>=1&&a.vertices.push(...function(t,e){t.seek_start(e);const s=t.u16();t.seek(2);const i=t.u32(),n=t.u32(),r=t.u32(),o=[];for(let e=0;e<r;++e){t.seek_start(i+e*n);const r=t.vec3_f32();let a,c;switch(s){case 3:a=t.vec3_f32(),c=t.vec2_f32();break;case 4:break;case 5:t.seek(4),c=t.vec2_f32();break;case 6:a=t.vec3_f32();break;case 7:a=t.vec3_f32(),c=t.vec2_f32();break;default:h.warn(`Unknown vertex type ${s} with size ${n}.`)}o.push({position:r,normal:a,uv:c})}return o}(t,e)),a.meshes.push(...d(t,i,n)),a.meshes.push(...d(t,r,o)),a}function d(t,e,s){const i=[];for(let n=0;n<s;++n){t.seek_start(e+20*n);const s=t.u32(),r=t.u32(),o=t.u32(),a=t.u32(),c=f(t,s,r);t.seek_start(o);const u=t.u16_array(a);i.push({material_properties:c,indices:u})}return i}function f(t,e,s){const i={};for(let n=0;n<s;++n){t.seek_start(e+16*n);switch(t.u32()){case 2:i.src_alpha=t.u32(),i.dst_alpha=t.u32();break;case 3:i.texture_id=t.u32();break;case 5:i.diffuse_r=t.u8(),i.diffuse_g=t.u8(),i.diffuse_b=t.u8(),i.diffuse_a=t.u8()}}return i}var p=s(453),y=s(464);function b(t){return"njcm"===t.type}class w{constructor(t,e,s,i,n,r){this.evaluation_flags=t,this.model=e,this.position=s,this.rotation=i,this.scale=n,this._children=r,this.children=this._children}bone_count(){const t=[0];return this.get_bone_internal(this,Number.MAX_SAFE_INTEGER,t),t[0]}get_bone(t){return this.get_bone_internal(this,t,[0])}add_child(t){this._children.push(t)}clear_children(){this._children.splice(0)}get_bone_internal(t,e,s){if(!t.evaluation_flags.skip){if(s[0]++===e)return t}if(!t.evaluation_flags.break_child_trace)for(const i of t.children){const t=this.get_bone_internal(i,e,s);if(t)return t}}}function k(t){return v(t,a,[])}function g(t){return v(t,l,void 0)}function m(t){return x(t,l,void 0)}function v(t,e,s){const n=Object(i.a)(t);if(!n.success)return n;const r=n.value.filter(t=>1296255566===t.type),o=[];for(const t of r)o.push(...x(t.data,e,s));return Object(p.d)(o,...n.problems)}function x(t,e,s){const i=t.u32(),n=0!=(1&i),r=0!=(2&i),o=0!=(4&i),a=0!=(8&i),c=0!=(16&i),u=0!=(32&i),_=0!=(64&i),h=0!=(128&i),l=t.u32(),d=t.vec3_f32(),f={x:Object(y.a)(t.i32()),y:Object(y.a)(t.i32()),z:Object(y.a)(t.i32())},p=t.vec3_f32(),b=t.u32(),k=t.u32();let g,m,v;l&&(t.seek_start(l),g=e(t,s)),b?(t.seek_start(b),m=x(t,e,s)):m=[],k?(t.seek_start(k),v=x(t,e,s)):v=[];return[new w({no_translate:n,no_rotate:r,no_scale:o,hidden:a,break_child_trace:c,zxy_rotation_order:u,skip:_,shape_skip:h},g,d,f,p,m),...v]}},540:function(t,e,s){"use strict";s.d(e,"a",(function(){return c})),s.d(e,"b",(function(){return u}));var i=s(512),n=s(24),r=s(453),o=s(28);const a=n.a.get("core/data_formats/parsing/ninja/texture");function c(t){const e=Object(i.b)(t,!0);return t.seek_start(0),e.success&&null!=e.value.find(t=>1213027928===t.type||1414682200===t.type)}function u(t){const e=Object(i.a)(t);if(!e.success)return e;const s=new r.a(a);s.add_result(e);const n=e.value,c=n.find(t=>1213027928===t.type),u=c&&function(t){return{texture_count:t.u16()}}(c.data),_=n.filter(t=>1414682200===t.type).map(t=>function(t){const e=t.u32(),s=t.u32(),i=t.u32(),n=t.u16(),r=t.u16(),o=t.u32();return t.seek(36),{id:i,format:[e,s],width:n,height:r,size:o,data:t.array_buffer(o)}}(t.data));return u||0!==_.length?(u&&u.texture_count!==_.length&&s.add_problem(o.b.Warning,"Corrupted XVM file.",`Found ${_.length} textures instead of ${u.texture_count} as defined in the header.`),s.success({textures:_})):(s.add_problem(o.b.Error,"Corrupted XVM file.","No header and no XVRT chunks found."),s.failure())}},544:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s(24),n=s(453),r=s(28);const o=i.a.get("core/data_formats/parsing/afs");function a(t){const e=new n.a(o);if(t.bytes_left<8)return e.add_problem(r.b.Error,"AFS archive is corrupted.","Too small to be an AFS archive.").failure();if(5457473!==t.u32())return e.add_problem(r.b.Error,"AFS archive is corrupted.","Magic bytes not present.").failure();const s=t.u16();t.seek(2);const i=[];for(let n=1;n<=s;n++){if(t.bytes_left<8){e.add_problem(r.b.Warning,`AFS file entry ${n} is invalid.`,`Couldn't read file entry ${n}, only ${t.bytes_left} bytes left.`);break}const s=t.u32(),o=t.u32();if(s>t.size)e.add_problem(r.b.Warning,`AFS file entry ${n} is invalid.`,`Invalid file offset ${s} for entry ${n}.`);else if(s+o>t.size)e.add_problem(r.b.Warning,`AFS file entry ${n} is invalid.`,`File size ${o} (offset: ${s}) of entry ${n} too large.`);else{const e=t.position;t.seek_start(s),i.push(t.array_buffer(o)),t.seek_start(e)}}return e.success(i)}},550:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));class i{constructor(t){this._position=0,this.offset=t}get position(){return this._position}get bytes_left(){return this.size-this._position}get absolute_position(){return this.offset+this._position}seek(t){return this.seek_start(this.position+t)}seek_start(t){if(t<0||t>this.size)throw new Error(`Offset ${t} is out of bounds.`);return this._position=t,this}seek_end(t){if(t<0||t>this.size)throw new Error(`Offset ${t} is out of bounds.`);return this._position=this.size-t,this}vec2_f32(){return{x:this.f32(),y:this.f32()}}vec3_f32(){return{x:this.f32(),y:this.f32(),z:this.f32()}}string_ascii(t,e,s){const i=[];for(let n=0;n<t;n++){const r=this.u8();if(e&&0===r){s&&this.seek(t-n-1);break}i.push(r)}return String.fromCodePoint(...i)}string_utf16(t,e,s){const i=[],n=Math.floor(t/2);for(let t=0;t<n;t++){const r=this.u16();if(e&&0===r){s&&this.seek(2*(n-t-1));break}i.push(r)}return String.fromCodePoint(...i)}write_u8_array(t){const e=t.length;this.check_size(e);for(let s=0;s<e;s++)this.write_u8(t[s]);return this}write_u16_array(t){const e=t.length;this.check_size(2*e);for(let s=0;s<e;s++)this.write_u16(t[s]);return this}write_u32_array(t){const e=t.length;this.check_size(4*e);for(let s=0;s<e;s++)this.write_u32(t[s]);return this}write_i32_array(t){const e=t.length;this.check_size(4*e);for(let s=0;s<e;s++)this.write_i32(t[s]);return this}write_vec2_f32(t){return this.check_size(8),this.write_f32(t.x),this.write_f32(t.y),this}write_vec3_f32(t){return this.check_size(12),this.write_f32(t.x),this.write_f32(t.y),this.write_f32(t.z),this}write_string_ascii(t,e){this.check_size(e);const s=Math.min(e,t.length);for(let e=0;e<s;e++)this.write_u8(t.codePointAt(e));const i=e-s;for(let t=0;t<i;t++)this.write_u8(0);return this}write_string_utf16(t,e){this.check_size(e);const s=Math.floor(e/2),i=Math.min(s,t.length);for(let e=0;e<i;e++)this.write_u16(t.codePointAt(e));const n=s-i;for(let t=0;t<n;t++)this.write_u16(0);return this}check_size(t){const e=this.size-this._position;if(t>e)throw new Error(`${t} Bytes required but only ${e} available.`)}}},631:function(t,e,s){"use strict";s.d(e,"g",(function(){return n})),s.d(e,"h",(function(){return r})),s.d(e,"f",(function(){return o})),s.d(e,"e",(function(){return a})),s.d(e,"k",(function(){return c})),s.d(e,"l",(function(){return u})),s.d(e,"j",(function(){return _})),s.d(e,"i",(function(){return h})),s.d(e,"a",(function(){return l})),s.d(e,"b",(function(){return d})),s.d(e,"d",(function(){return f})),s.d(e,"c",(function(){return p}));class i{constructor(t){var e,s,i,n,r;this.name=t.name,this.body_style_count=null!==(e=t.body_style_count)&&void 0!==e?e:1,this.head_style_count=t.head_style_count,this.hair_style_count=t.hair_style_count,this.hair_styles_with_accessory=t.hair_styles_with_accessory,this.body_tex_ids=null!==(s=t.body_tex_ids)&&void 0!==s?s:[],this.head_tex_ids=null!==(i=t.head_tex_ids)&&void 0!==i?i:[],this.hair_tex_ids=null!==(n=t.hair_tex_ids)&&void 0!==n?n:[],this.accessory_tex_ids=null!==(r=t.accessory_tex_ids)&&void 0!==r?r:[]}}const n=new i({name:"HUmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([6])}),r=new i({name:"HUnewearl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set}),o=new i({name:"HUcast",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),a=new i({name:"HUcaseal",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),c=new i({name:"RAmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),u=new i({name:"RAmarl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),_=new i({name:"RAcast",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),h=new i({name:"RAcaseal",body_style_count:25,head_style_count:5,hair_style_count:0,hair_styles_with_accessory:new Set}),l=new i({name:"FOmar",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),d=new i({name:"FOmarl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),f=new i({name:"FOnewm",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])}),p=new i({name:"FOnewearl",body_style_count:18,head_style_count:1,hair_style_count:10,hair_styles_with_accessory:new Set([0,1,2,3,4,5,6,7,8,9])})},829:function(t,e,s){"use strict";s.r(e),s.d(e,"CharacterClassAssetLoader",(function(){return d}));var i=s(513),n=s(466),r=s(457),o=s(491),a=s(631),c=s(540),u=s(544),_=s(32),h=s(453),l=function(t,e,s,i){return new(s||(s=Promise))((function(n,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))};class d{constructor(t){this.http_client=t,this.nj_object_cache=new Map,this.xvr_texture_cache=new Map,this.nj_motion_cache=new Map}dispose(){for(const t of this.nj_object_cache.values())t.dispose();for(const t of this.nj_motion_cache.values())t.dispose();this.nj_object_cache.clear(),this.nj_motion_cache.clear()}load_geometry(t){let e=this.nj_object_cache.get(t.name);return e||(e=this.load_all_nj_objects(t),this.nj_object_cache.set(t.name,e)),e}load_all_nj_objects(t){const e=f(t,_.e.Viridia,0);return this.load_body_part_geometry(t.name,"Body").then(s=>{if(!s)throw new Error(`Couldn't load body for player class ${t.name}.`);return this.load_body_part_geometry(t.name,"Head",0).then(i=>{if(!i)return s;let n=1+e.body.length;return this.shift_texture_ids(i,n),this.add_to_bone(s,i,59),0===t.hair_style_count?s:this.load_body_part_geometry(t.name,"Hair",0).then(r=>r?(n+=e.head.length,this.shift_texture_ids(r,n),this.add_to_bone(i,r,0),t.hair_styles_with_accessory.has(0)?this.load_body_part_geometry(t.name,"Accessory",0).then(t=>(t&&(n+=e.hair.length,this.shift_texture_ids(t,n),this.add_to_bone(r,t,0)),s)):s):s)})})}load_body_part_geometry(t,e,s){return this.http_client.get(function(t,e,s){return`/player/${t}${e}${null==s?"":s}.nj`}(t,e,s)).array_buffer().then(t=>Object(h.e)(Object(i.b)(new n.a(t,r.a.Little)))[0])}shift_texture_ids(t,e){if(t.model)for(const s of t.model.meshes)null!=s.texture_id&&(s.texture_id+=e);for(const s of t.children)this.shift_texture_ids(s,e)}add_to_bone(t,e,s){const i=t.get_bone(s);i&&(i.evaluation_flags.hidden=!1,i.evaluation_flags.break_child_trace=!1,i.add_child(e))}load_textures(t,e,s){return l(this,void 0,void 0,(function*(){let i=this.xvr_texture_cache.get(t.name);i||(i=this.http_client.get(`/player/${t.name}Tex.afs`).array_buffer().then(t=>{const e=Object(u.a)(new n.a(t,r.a.Little)),s=[];if(e.success)for(const t of e.value){const e=Object(c.b)(new n.a(t,r.a.Little));e.success&&s.push(...e.value.textures)}return s}));const o=yield i,a=f(t,e,s);return[a.section_id,...a.body,...a.head,...a.hair,...a.accessories].map(t=>null==t?void 0:o[t])}))}load_animation(t,e){let s=this.nj_motion_cache.get(t);return s||(s=this.http_client.get(`/player/animation/animation_${t.toString().padStart(3,"0")}.njm`).array_buffer().then(t=>Object(o.c)(new n.a(t,r.a.Little),e))),s}}function f(t,e,s){switch(t){case a.g:{const t=3*s;return{section_id:e+126,body:[t,t+1,t+2,s+108],head:[54,55],hair:[94,95],accessories:[]}}case a.h:{const t=13*s;return{section_id:e+299,body:[t+13,t,t+1,t+2,t+3,277,s+281],head:[235,239],hair:[260,259],accessories:[]}}case a.f:{const t=5*s;return{section_id:e+275,body:[t,t+1,t+2,s+250],head:[t+3,t+4],hair:[],accessories:[]}}case a.e:{const t=5*s;return{section_id:e+375,body:[t,t+1,t+2],head:[t+3,t+4],hair:[],accessories:[]}}case a.k:{const t=7*s;return{section_id:e+197,body:[t+4,t+5,t+6,s+179],head:[126,127],hair:[166,167],accessories:[void 0,void 0,t+2]}}case a.l:{const t=16*s;return{section_id:e+322,body:[t+15,t+1,t],head:[288],hair:[308,309],accessories:[void 0,void 0,t+8]}}case a.j:{const t=5*s;return{section_id:e+300,body:[t,t+1,t+2,t+3,s+275],head:[t+4],hair:[],accessories:[]}}case a.i:{const t=5*s;return{section_id:e+375,body:[s+350,t,t+1,t+2],head:[t+3],hair:[t+4],accessories:[]}}case a.a:{const t=0===s?0:15*s+2;return{section_id:e+310,body:[t+12,t+13,t+14,t],head:[276,272],hair:[void 0,296,297],accessories:[t+4]}}case a.b:{const t=16*s;return{section_id:e+326,body:[t,t+2,t+1,322],head:[288],hair:[void 0,void 0,308],accessories:[t+3,t+4]}}case a.d:{const t=17*s;return{section_id:e+344,body:[t+4,340,t,t+5],head:[306,310],hair:[void 0,void 0,330],accessories:[t+6,t+16,330]}}case a.c:{const t=26*s;return{section_id:e+505,body:[t+1,t,t+2,501],head:[472,468],hair:[void 0,void 0,492],accessories:[t+12,t+13]}}default:throw new Error(`No textures for character class ${t.name}.`)}}}}]);